{
  "ID": "oval:org.debian:def:20030773",
  "Class": "vulnerability",
  "Metadata": {
    "Title": "CVE-2003-0773",
    "AffectedList": [
      {
        "Family": "unix",
        "Platform": "Debian GNU/Linux 10",
        "Product": "sane-backends"
      }
    ],
    "References": [
      {
        "Source": "CVE",
        "RefID": "CVE-2003-0773",
        "RefURL": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2003-0773"
      }
    ],
    "Description": "saned in sane-backends 1.0.7 and earlier does not check the IP address of the connecting host during the SANE_NET_INIT RPC call, which allows remote attackers to use that call even if they are restricted in saned.conf.",
    "Debian": {
      "MoreInfo": "\nDSA-379\nAlexander Hvostov, Julien Blache and Aurelien Jarno discovered several\nsecurity-related problems in the sane-backends package, which contains\nan API library for scanners including a scanning daemon (in the\npackage libsane) that can be remotely exploited.  These problems allow\na remote attacker to cause a segmentation fault and/or consume arbitrary\namounts of memory.  The attack is successful, even if the attacker's\ncomputer isn't listed in saned.conf.\nYou are only vulnerable if you actually run saned e.g. in xinetd or\ninetd.  If the entries in the configuration file of xinetd or inetd\nrespectively are commented out or do not exist, you are safe.\nTry \"\u003ckbd\u003etelnet localhost 6566\u003c/kbd\u003e\" on the server that may run saned.\nIf you\nget \"connection refused\" saned is not running and you are safe.\nThe Common Vulnerabilities and Exposures project identifies the\nfollowing problems:\n\n\u003cul\u003e\n\n\u003cli\u003e\u003ca href=\"https://cve.mitre.org/cgi-bin/cvename.cgi?name=CAN-2003-0773\"\u003eCAN-2003-0773\u003c/a\u003e:\n\n\u003cp\u003esaned checks the identity (IP address) of the remote host only\n   after the first communication took place (SANE_NET_INIT).  So\n   everyone can send that RPC, even if the remote host is not allowed\n   to scan (not listed in saned.conf).\nsaned lacks error checking nearly everywhere in the code. So\n   connection drops are detected very late. If the drop of the\n   connection isn't detected, the access to the internal wire buffer\n   leaves the limits of the allocated memory. So random memory \"after\"\n   the wire buffer is read which will be followed by a segmentation\n   fault.\nIf saned expects strings, it mallocs the memory necessary to store\n   the complete string after it receives the size of the string. If\n   the connection was dropped before transmitting the size, malloc\n   will reserve an arbitrary size of memory. Depending on that size\n   and the amount of memory available either malloc fails (-\u0026gt;saned\n   quits nicely) or a huge amount of memory is allocated. Swapping\n   and OOM measures may occur depending on the kernel.\nsaned doesn't check the validity of the RPC numbers it gets before\n   getting the parameters.\nIf debug messages are enabled and a connection is dropped,\n   non-null-terminated strings may be printed and segmentation faults\n   may occur.\nIt's possible to allocate an arbitrary amount of memory on the\n   server running saned even if the connection isn't dropped.  At the\n   moment this cannot easily be fixed according to the author.\n   Better limit the total amount of memory saned may use (ulimit).\n"
    }
  },
  "Criteria": {
    "Operator": "AND",
    "Criterias": [
      {
        "Operator": "OR",
        "Criterias": [
          {
            "Operator": "AND",
            "Criterias": null,
            "Criterions": [
              {
                "Negate": false,
                "TestRef": "oval:org.debian.oval:tst:2",
                "Comment": "all architecture"
              },
              {
                "Negate": false,
                "TestRef": "oval:org.debian.oval:tst:386",
                "Comment": "libsane DPKG is earlier than 1.0.11-1"
              }
            ]
          }
        ],
        "Criterions": null
      }
    ],
    "Criterions": [
      {
        "Negate": false,
        "TestRef": "oval:org.debian.oval:tst:1",
        "Comment": "Debian 10 is installed"
      }
    ]
  }
}