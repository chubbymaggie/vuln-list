{
  "ID": "oval:org.debian:def:20080166",
  "Class": "vulnerability",
  "Metadata": {
    "Title": "CVE-2008-0166",
    "AffectedList": [
      {
        "Family": "unix",
        "Platform": "Debian GNU/Linux 10",
        "Product": "openssl"
      }
    ],
    "References": [
      {
        "Source": "CVE",
        "RefID": "CVE-2008-0166",
        "RefURL": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-0166"
      }
    ],
    "Description": "OpenSSL 0.9.8c-1 up to versions before 0.9.8g-9 on Debian-based operating systems uses a random number generator that generates predictable numbers, which makes it easier for remote attackers to conduct brute force guessing attacks against cryptographic keys.",
    "Debian": {
      "MoreInfo": "\nDSA-1576\nThe recently announced vulnerability in Debian's openssl package\n(\u003ca href=\"/security/2008/dsa-1571\"\u003eDSA-1571-1\u003c/a\u003e, \u003ca href=\"https://security-tracker.debian.org/tracker/CVE-2008-0166\"\u003eCVE-2008-0166\u003c/a\u003e) indirectly affects OpenSSH.  As a result,\nall user and host keys generated using broken versions of the openssl\npackage must be considered untrustworthy, even after the openssl update\nhas been applied.\n1. Install the security updates\nThis update contains a dependency on the openssl update and will\n   automatically install a corrected version of the libssl0.9.8 package,\n   and a new package openssh-blacklist.\nOnce the update is applied, weak user keys will be automatically\n   rejected where possible (though they cannot be detected in all\n   cases).  If you are using such keys for user authentication, they\n   will immediately stop working and will need to be replaced (see\n   step 3).\nOpenSSH host keys can be automatically regenerated when the OpenSSH\n   security update is applied.  The update will prompt for confirmation\n   before taking this step.\n2. Update OpenSSH known_hosts files\nThe regeneration of host keys will cause a warning to be displayed when\n   connecting to the system using SSH until the host key is updated in the\n   known_hosts file.  The warning will look like this:\nIn this case, the host key has simply been changed, and you should update\n   the relevant known_hosts file as indicated in the error message.\n   \n   It is recommended that you use a trustworthy channel to exchange the\n   server key.  It is found in the file /etc/ssh/ssh_host_rsa_key.pub on\n   the server; it's fingerprint can be printed using the command:\nssh-keygen -l -f /etc/ssh/ssh_host_rsa_key.pub\nIn addition to user-specific known_hosts files, there may be a\n   system-wide known hosts file /etc/ssh/ssh_known_hosts.  This is file is\n   used both by the ssh client and by sshd for the hosts.equiv\n   functionality.  This file needs to be updated as well.\n3. Check all OpenSSH user keys\nThe safest course of action is to regenerate all OpenSSH user keys,\n   except where it can be established to a high degree of certainty that the\n   key was generated on an unaffected system.\nCheck whether your key is affected by running the ssh-vulnkey tool, included\n   in the security update.  By default, ssh-vulnkey will check the standard\n   location for user keys (~/.ssh/id_rsa, ~/.ssh/id_dsa and ~/.ssh/identity),\n   your authorized_keys file (~/.ssh/authorized_keys and\n   ~/.ssh/authorized_keys2), and the system's host keys\n   (/etc/ssh/ssh_host_dsa_key and /etc/ssh/ssh_host_rsa_key).\nTo check all your own keys, assuming they are in the standard\n   locations (~/.ssh/id_rsa, ~/.ssh/id_dsa, or ~/.ssh/identity):\nssh-vulnkey\nTo check all keys on your system:\nsudo ssh-vulnkey -a\nTo check a key in a non-standard location:\nssh-vulnkey /path/to/key\nIf ssh-vulnkey says \"Unknown (no blacklist information)\", then it has no\n   information about whether that key is affected.  In this case, you\n   can examine the modification time (mtime) of the file using \"ls -l\".\n   Keys generated before September 2006 are not affected.  Keep in mind\n   that, although unlikely, backup procedures may have changed the file\n   date back in time (or the system clock may have been incorrectly\n   set).\n   \n   If in doubt, generate a new key and remove the old one from any\n   servers.\n4. Regenerate any affected user keys\nOpenSSH keys used for user authentication must be manually regenerated,\n   including those which may have since been transferred to a different system\n   after being generated.\nNew keys can be generated using ssh-keygen, e.g.:\n5. Update authorized_keys files (if necessary)\nOnce the user keys have been regenerated, the relevant public keys\n   must be propagated to any authorized_keys files (and authorized_keys2\n   files, if applicable) on remote systems.  Be sure to delete the lines\n   containing old keys from those files.\nIn addition to countermeasures to mitigate the randomness vulnerability,\nthis OpenSSH update fixes several other vulnerabilities:\n\u003ca href=\"https://security-tracker.debian.org/tracker/CVE-2008-1483\"\u003eCVE-2008-1483\u003c/a\u003e:\n   Timo Juhani Lindfors discovered that, when using X11 forwarding, the\n   SSH client selects an X11 forwarding port without ensuring that it\n   can be bound on all address families. If the system is configured\n   with IPv6 (even if it does not have working IPv6 connectivity), this\n   could allow a local attacker on the remote server to hijack X11\n   forwarding.\n\u003ca href=\"https://security-tracker.debian.org/tracker/CVE-2007-4752\"\u003eCVE-2007-4752\u003c/a\u003e:\n   Jan Pechanec discovered that ssh falls back to creating a trusted X11\n   cookie if creating an untrusted cookie fails, potentially exposing\n   the local display to a malicious remote server when using X11\n   forwarding.\n"
    }
  },
  "Criteria": {
    "Operator": "AND",
    "Criterias": [
      {
        "Operator": "OR",
        "Criterias": [
          {
            "Operator": "AND",
            "Criterias": null,
            "Criterions": [
              {
                "Negate": false,
                "TestRef": "oval:org.debian.oval:tst:2",
                "Comment": "all architecture"
              },
              {
                "Negate": false,
                "TestRef": "oval:org.debian.oval:tst:2621",
                "Comment": "openssh DPKG is earlier than of"
              }
            ]
          }
        ],
        "Criterions": null
      }
    ],
    "Criterions": [
      {
        "Negate": false,
        "TestRef": "oval:org.debian.oval:tst:1",
        "Comment": "Debian 10 is installed"
      }
    ]
  }
}