{
  "ID": "oval:org.debian:def:20090843",
  "Class": "vulnerability",
  "Metadata": {
    "Title": "CVE-2009-0843",
    "AffectedList": [
      {
        "Family": "unix",
        "Platform": "Debian GNU/Linux 10",
        "Product": "mapserver"
      }
    ],
    "References": [
      {
        "Source": "CVE",
        "RefID": "CVE-2009-0843",
        "RefURL": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-0843"
      }
    ],
    "Description": "The msLoadQuery function in mapserv in MapServer 4.x before 4.10.4 and 5.x before 5.2.2 allows remote attackers to determine the existence of arbitrary files via a full pathname in the queryfile parameter, which triggers different error messages depending on whether this pathname exists.",
    "Debian": {
      "MoreInfo": "\nDSA-1914\nSeveral vulnerabilities have been discovered in mapserver, a CGI-based\nweb framework to publish spatial data and interactive mapping applications.\nThe Common Vulnerabilities and Exposures project identifies the following\nproblems:\nMissing input validation on a user supplied map queryfile name can be\n  used by an attacker to check for the existence of a specific file by\n  using the queryfile GET parameter and checking for differences in error\n  messages.\nA lack of file type verification when parsing a map file can lead to\n  partial disclosure of content from arbitrary files through parser error\n  messages.\nDue to missing input validation when saving map files under certain\n  conditions it is possible to perform directory traversal attacks and\n  to create arbitrary files.\n  NOTE: Unless the attacker is able to create directories in the image\n  path or there is already a readable directory this doesn't affect\n  installations on Linux as the fopen() syscall will fail in case a sub\n  path is not readable.\nIt was discovered that mapserver is vulnerable to a stack-based buffer\n  overflow when processing certain GET parameters.  An attacker can use\n  this to execute arbitrary code on the server via crafted id parameters.\nAn integer overflow leading to a heap-based buffer overflow when\n  processing the Content-Length header of an HTTP request can be used by an\n  attacker to execute arbitrary code via crafted POST requests containing\n  negative Content-Length values.\nAn integer overflow when processing HTTP requests can lead to a\n  heap-based buffer overflow. An attacker can use this to execute arbitrary\n  code either via crafted Content-Length values or large HTTP request. This\n  is partly because of an incomplete fix for\n  \u003ca href=\"https://security-tracker.debian.org/tracker/CVE-2009-0840\"\u003eCVE-2009-0840\u003c/a\u003e.\n"
    }
  },
  "Criteria": {
    "Operator": "AND",
    "Criterias": [
      {
        "Operator": "OR",
        "Criterias": [
          {
            "Operator": "AND",
            "Criterias": null,
            "Criterions": [
              {
                "Negate": false,
                "TestRef": "oval:org.debian.oval:tst:2",
                "Comment": "all architecture"
              },
              {
                "Negate": false,
                "TestRef": "oval:org.debian.oval:tst:3348",
                "Comment": "mapserver DPKG is earlier than 5.4.2-1"
              }
            ]
          }
        ],
        "Criterions": null
      }
    ],
    "Criterions": [
      {
        "Negate": false,
        "TestRef": "oval:org.debian.oval:tst:1",
        "Comment": "Debian 10 is installed"
      }
    ]
  }
}