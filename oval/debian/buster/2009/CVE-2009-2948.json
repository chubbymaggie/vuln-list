{
  "ID": "oval:org.debian:def:20092948",
  "Class": "vulnerability",
  "Metadata": {
    "Title": "CVE-2009-2948",
    "AffectedList": [
      {
        "Family": "unix",
        "Platform": "Debian GNU/Linux 10",
        "Product": "samba"
      }
    ],
    "References": [
      {
        "Source": "CVE",
        "RefID": "CVE-2009-2948",
        "RefURL": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-2948"
      }
    ],
    "Description": "mount.cifs in Samba 3.0 before 3.0.37, 3.2 before 3.2.15, 3.3 before 3.3.8 and 3.4 before 3.4.2, when mount.cifs is installed suid root, does not properly enforce permissions, which allows local users to read part of the credentials file and obtain the password by specifying the path to the credentials file and using the --verbose or -v option.",
    "Debian": {
      "MoreInfo": "\nDSA-1908\nSeveral vulnerabilities have been discovered in samba, an implementation of\nthe SMB/CIFS protocol for Unix systems, providing support for cross-platform\nfile and printer sharing with other operating systems and more.  The Common\nVulnerabilities and Exposures project identifies the following problems:\nThe mount.cifs utility is missing proper checks for file permissions when\nused in verbose mode.  This allows local users to partly disclose the\ncontent of arbitrary files by specifying the file as credentials file and\nattempting to mount a samba share.\nA reply to an oplock break notification which samba doesn't expect could\nlead to the service getting stuck in an infinite loop.  An attacker\ncan use this to perform denial of service attacks via a specially crafted\nSMB request.\nA lack of error handling in case no home directory was configured/specified\nfor the user could lead to file disclosure.  In case the automated [homes]\nshare is enabled or an explicit share is created with that username, samba\nfails to enforce sharing restrictions which results in an attacker being\nable to access the file system from the root directory.\n"
    }
  },
  "Criteria": {
    "Operator": "AND",
    "Criterias": [
      {
        "Operator": "OR",
        "Criterias": [
          {
            "Operator": "AND",
            "Criterias": null,
            "Criterions": [
              {
                "Negate": false,
                "TestRef": "oval:org.debian.oval:tst:2",
                "Comment": "all architecture"
              },
              {
                "Negate": false,
                "TestRef": "oval:org.debian.oval:tst:3625",
                "Comment": "samba DPKG is earlier than 2:3.4.2-1"
              }
            ]
          }
        ],
        "Criterions": null
      }
    ],
    "Criterions": [
      {
        "Negate": false,
        "TestRef": "oval:org.debian.oval:tst:1",
        "Comment": "Debian 10 is installed"
      }
    ]
  }
}