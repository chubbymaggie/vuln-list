{
  "Class": "vulnerability",
  "ID": "oval:com.redhat.cve:def:202014318",
  "Version": "631",
  "Metadata": {
    "Title": "CVE-2020-14318 samba: Missing handle permissions check in SMB1/2/3 ChangeNotify (moderate)",
    "References": [
      {
        "Source": "CVE",
        "RefID": "CVE-2020-14318",
        "RefURL": "https://access.redhat.com/security/cve/CVE-2020-14318"
      }
    ],
    "Description": "DOCUMENTATION: A flaw was found in the way samba handled file and directory permissions. An authenticated user could use this flaw to gain access to certain file and directory information which otherwise would be unavailable to the attacker.\n            \n            MITIGATION: As Samba internally opens an underlying file system handle on a directory when a client requests an open, even for FILE_READ_ATTRIBUTES then if the underlying file system permissions don't allow \"r\" (read) access for the connected user, then the handle open request will be denied.\n\n\"r\" access is the normal permission needed to list or otherwise reveal the contents of a directory, so if a connected user has \"r\" access then they will be able to list the directory contents normally, and the information received by a ChangeNofity request is already available to the user.\n\nThe security issue occurs if the Administrator or directory owner had set more restrictive Windows ACL permissions on the directory to disallow read access to the user, and this permissions change was not reflected in the underlying file system permissions.\n\nThis will only occur if Samba is configured with VFS modules to decouple the underlying file system permissions from the Windows ACLs, by setting up a share with the settings:\n\n[vulnerable_share]\n        vfs_objects = vfs_acl_xattr\n        acl_xattr:ignore system acls = yes",
    "Advisory": {
      "From": "secalert@redhat.com",
      "Severity": "Moderate",
      "Issued": {},
      "Updated": {}
    }
  },
  "Criteria": {
    "Operator": "OR",
    "Criterions": [
      {
        "Comment": "Red Hat Enterprise Linux must be installed",
        "TestRef": "oval:com.redhat.cve:tst:201610089010"
      }
    ],
    "Criterias": [
      {
        "Operator": "AND",
        "Criterions": [
          {
            "Comment": "Red Hat Enterprise Linux 6 is installed",
            "TestRef": "oval:com.redhat.cve:tst:201610089009"
          }
        ],
        "Criterias": [
          {
            "Operator": "OR",
            "Criterias": [
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "samba-test-libs is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202014318001"
                  },
                  {
                    "Comment": "samba-test-libs is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202014318002"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "samba-debuginfo is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202014318003"
                  },
                  {
                    "Comment": "samba-debuginfo is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202014318004"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "libsmbclient is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202014318005"
                  },
                  {
                    "Comment": "libsmbclient is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202014318006"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "samba-python is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202014318007"
                  },
                  {
                    "Comment": "samba-python is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202014318008"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "samba-swat is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202014318009"
                  },
                  {
                    "Comment": "samba-swat is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202014318010"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "samba-vfs-glusterfs is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202014318011"
                  },
                  {
                    "Comment": "samba-vfs-glusterfs is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202014318012"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "samba-client is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202014318013"
                  },
                  {
                    "Comment": "samba-client is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202014318014"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "ctdb-devel is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202014318015"
                  },
                  {
                    "Comment": "ctdb-devel is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202014318016"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "libwbclient is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202014318017"
                  },
                  {
                    "Comment": "libwbclient is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202014318018"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "samba-krb5-printing is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202014318019"
                  },
                  {
                    "Comment": "samba-krb5-printing is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202014318020"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "samba-test-devel is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202014318021"
                  },
                  {
                    "Comment": "samba-test-devel is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202014318022"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "samba-common is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202014318023"
                  },
                  {
                    "Comment": "samba-common is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202014318024"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "ctdb is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202014318025"
                  },
                  {
                    "Comment": "ctdb is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202014318026"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "samba-pidl is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202014318027"
                  },
                  {
                    "Comment": "samba-pidl is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202014318028"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "samba-common-libs is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202014318029"
                  },
                  {
                    "Comment": "samba-common-libs is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202014318030"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "samba-client-libs is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202014318031"
                  },
                  {
                    "Comment": "samba-client-libs is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202014318032"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "libsmbclient-devel is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202014318033"
                  },
                  {
                    "Comment": "libsmbclient-devel is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202014318034"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "samba-glusterfs is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202014318035"
                  },
                  {
                    "Comment": "samba-glusterfs is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202014318036"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "samba-test is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202014318037"
                  },
                  {
                    "Comment": "samba-test is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202014318038"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "samba-winbind-clients is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202014318039"
                  },
                  {
                    "Comment": "samba-winbind-clients is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202014318040"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "samba-dc is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202014318041"
                  },
                  {
                    "Comment": "samba-dc is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202014318042"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "samba-domainjoin-gui is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202014318043"
                  },
                  {
                    "Comment": "samba-domainjoin-gui is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202014318044"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "samba-dc-libs is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202014318045"
                  },
                  {
                    "Comment": "samba-dc-libs is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202014318046"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "samba is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202014318047"
                  },
                  {
                    "Comment": "samba is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202014318048"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "samba-winbind-krb5-locator is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202014318049"
                  },
                  {
                    "Comment": "samba-winbind-krb5-locator is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202014318050"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "samba-winbind is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202014318051"
                  },
                  {
                    "Comment": "samba-winbind is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202014318052"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "samba-doc is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202014318053"
                  },
                  {
                    "Comment": "samba-doc is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202014318054"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "libwbclient-devel is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202014318055"
                  },
                  {
                    "Comment": "libwbclient-devel is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202014318056"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "samba-winbind-devel is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202014318057"
                  },
                  {
                    "Comment": "samba-winbind-devel is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202014318058"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "ctdb-tests is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202014318059"
                  },
                  {
                    "Comment": "ctdb-tests is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202014318060"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "samba-common-tools is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202014318061"
                  },
                  {
                    "Comment": "samba-common-tools is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202014318062"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "samba-devel is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202014318063"
                  },
                  {
                    "Comment": "samba-devel is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202014318064"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "samba-winbind-modules is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202014318065"
                  },
                  {
                    "Comment": "samba-winbind-modules is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202014318066"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "samba-libs is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202014318067"
                  },
                  {
                    "Comment": "samba-libs is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202014318068"
                  }
                ]
              }
            ]
          }
        ]
      }
    ]
  }
}