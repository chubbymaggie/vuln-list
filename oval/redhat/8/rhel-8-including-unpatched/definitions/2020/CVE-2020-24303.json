{
  "Class": "vulnerability",
  "ID": "oval:com.redhat.cve:def:202024303",
  "Version": "631",
  "Metadata": {
    "Title": "CVE-2020-24303 grafana: XSS via a query alias for the Elasticsearch and Testdata datasource (moderate)",
    "References": [
      {
        "Source": "CVE",
        "RefID": "CVE-2020-24303",
        "RefURL": "https://access.redhat.com/security/cve/CVE-2020-24303"
      }
    ],
    "Description": "STATEMENT: A vulnerable version of Grafana is shipped in OpenShift 3.11 - 4.5 and OpenShift ServiceMesh, however Prometheus is used as a data source and modification to Elasticsearch or Testdata requires full control of the grafana component. Access is restricted to authenticated users only by OpenShift OAuth. As OpenShift and OpenShift ServiceMesh still packages the vulnerable code, the components are affected but with impact Low. OpenShift 4.6 uses version 7.2.0 of Grafana in openshift4/ose-grafana-container and is not affected.",
    "Advisory": {
      "From": "secalert@redhat.com",
      "Severity": "Moderate",
      "Issued": {},
      "Updated": {}
    }
  },
  "Criteria": {
    "Operator": "OR",
    "Criterions": [
      {
        "Comment": "Red Hat Enterprise Linux must be installed",
        "TestRef": "oval:com.redhat.cve:tst:20137488004"
      }
    ],
    "Criterias": [
      {
        "Operator": "AND",
        "Criterions": [
          {
            "Comment": "Red Hat Enterprise Linux 8 is installed",
            "TestRef": "oval:com.redhat.cve:tst:20137488003"
          }
        ],
        "Criterias": [
          {
            "Operator": "OR",
            "Criterias": [
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "grafana-cloudwatch is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202024303001"
                  },
                  {
                    "Comment": "grafana-cloudwatch is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202024303002"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "grafana-stackdriver is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202024303003"
                  },
                  {
                    "Comment": "grafana-stackdriver is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202024303004"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "grafana-opentsdb is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202024303005"
                  },
                  {
                    "Comment": "grafana-opentsdb is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202024303006"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "grafana-loki is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202024303007"
                  },
                  {
                    "Comment": "grafana-loki is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202024303008"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "grafana-mysql is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202024303009"
                  },
                  {
                    "Comment": "grafana-mysql is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202024303010"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "grafana-postgres is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202024303011"
                  },
                  {
                    "Comment": "grafana-postgres is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202024303012"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "grafana-influxdb is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202024303013"
                  },
                  {
                    "Comment": "grafana-influxdb is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202024303014"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "grafana-graphite is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202024303015"
                  },
                  {
                    "Comment": "grafana-graphite is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202024303016"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "grafana-prometheus is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202024303017"
                  },
                  {
                    "Comment": "grafana-prometheus is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202024303018"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "grafana-debuginfo is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202024303019"
                  },
                  {
                    "Comment": "grafana-debuginfo is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202024303020"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "grafana-mssql is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202024303021"
                  },
                  {
                    "Comment": "grafana-mssql is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202024303022"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "grafana-azure-monitor is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202024303023"
                  },
                  {
                    "Comment": "grafana-azure-monitor is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202024303024"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "grafana-elasticsearch is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202024303025"
                  },
                  {
                    "Comment": "grafana-elasticsearch is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202024303026"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "grafana is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202024303027"
                  },
                  {
                    "Comment": "grafana is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202024303028"
                  }
                ]
              }
            ]
          }
        ]
      }
    ]
  }
}